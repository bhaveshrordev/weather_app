<%= turbo_frame_tag "weather_data" do %>
    <% if @weather_data.present? && @weather_data["location"].present? && @weather_data["current"].present? %>
      <div class="card mt-4 shadow-lg">
        <div class="card-body">
          <h2 class="card-title text-center">Weather Details for <%= @weather_data["location"]["name"] %>, <%= @weather_data["location"]["region"] %></h2>
          
          <table class="table table-bordered mt-3">
            <thead class="thead-light">
              <tr>
                <th>Parameter</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Temperature</td>
                <td><%= @weather_data["current"]["temp_c"] %>°C / <%= @weather_data["current"]["temp_f"] %>°F</td>
              </tr>
              <tr>
                <td>Condition</td>
                <td><%= @weather_data["current"]["condition"]["text"] %></td>
              </tr>
              <tr>
                <td>Humidity</td>
                <td><%= @weather_data["current"]["humidity"] %>%</td>
              </tr>
              <tr>
                <td>Wind Speed</td>
                <td><%= @weather_data["current"]["wind_kph"] %> kph</td>
              </tr>
            </tbody>
          </table>

          <h2 class="card-title text-center">Forecast Data</h2>

          <table class="table table-bordered">
            <thead>
              <tr>
                <th>Date</th>
                <th>Maximum Temperature</th>
                <th>Minimum Temperature</th>
                <th>Average Temperature</th>
              </tr>
            </thead>

            <% @weather_data["forecast"]["forecastday"].each do |forecast| %>
              <tbody>
                <tr>
                  <td><%= Date.parse(forecast["date"]).strftime("%A, %B %d, %Y") %></td>
                  <td><%= forecast["day"]["maxtemp_c"] %>°C / <%= forecast["day"]["maxtemp_f"] %>°F</td>
                  <td><%= forecast["day"]["mintemp_c"] %>°C / <%= forecast["day"]["mintemp_f"] %>°F</td>
                  <td><%= forecast["day"]["avgtemp_c"] %>°C / <%= forecast["day"]["avgtemp_f"] %>°F</td>
                </tr>
              </tbody>
            <% end %>
          </table>

          <div class="text-center">
            <%= link_to "Close Details", root_path, class: "btn btn-outline-primary" %>
          </div>
        </div>
      </div>
    <% elsif params[:city].present? %>
      <div class="alert alert-warning mt-4 text-center">
        No data found for "<%= params[:city] %>". Please try again.
      </div>
    <% end %>
  <% end %>